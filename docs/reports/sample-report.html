<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sample Risk Analysis Report</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 40px; 
            line-height: 1.6; 
            color: #333;
            background: #f8f9fa;
        }
        .header { 
            text-align: center; 
            margin-bottom: 40px; 
            padding: 20px;
            background: #212529;
            color: white;
            border-bottom: 3px solid #495057;
        }
        .risk-score { 
            font-size: 3em; 
            font-weight: bold; 
            margin: 20px 0;
        }
        .section { 
            margin-bottom: 30px; 
            padding: 20px;
            background: white;
            border: 1px solid #e9ecef;
        }
        .permission-item, .risk-item, .recommendation-item, .csf-item { 
            padding: 15px; 
            margin: 10px 0; 
            border-left: 4px solid #ccc; 
            background: #f8f9fa;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .high { border-left-color: #fd7e14; }
        .critical { border-left-color: #dc3545; }
        .medium { border-left-color: #ffc107; }
        .low { border-left-color: #28a745; }
        .csf-item { border-left-color: #495057; }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0; 
            background: #f8f9fa;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        th, td { 
            border: 1px solid #e2e8f0; 
            padding: 12px; 
            text-align: left; 
        }
        th { 
            background-color: #495057; 
            color: white;
            font-weight: 600;
        }
        .score-badge {
            display: inline-block;
            padding: 4px 8px;
            color: white;
            font-weight: bold;
            font-size: 0.8em;
        }
        .score-critical { background: #dc3545; }
        .score-high { background: #fd7e14; }
        .score-medium { background: #ffc107; color: #333; }
        .score-low { background: #28a745; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîí Risk Analysis Report</h1>
        <div class="risk-score">75/100</div>
        <h2>Risk Level: HIGH</h2>
        <p>Generated on: December 10, 2024, 3:45 PM</p>
        <p><strong>Project:</strong> Customer Portal Application</p>
    </div>
    
    <div class="section">
        <h2>üìä Executive Summary</h2>
        <p>This risk analysis evaluates the Azure Application Registration permissions for a customer portal application. The analysis identified <strong>6 permissions</strong> with varying risk levels, mapped to <strong>8 NIST CSF 2.0 categories</strong>, and found <strong>4 significant risk indicators</strong>.</p>
        
        <table>
            <tr><th>Metric</th><th>Value</th><th>Status</th></tr>
            <tr><td>Overall Risk Score</td><td>75/100</td><td><span class="score-badge score-high">HIGH</span></td></tr>
            <tr><td>Detected Permissions</td><td>6</td><td>-</td></tr>
            <tr><td>Critical Permissions</td><td>2</td><td><span class="score-badge score-critical">CRITICAL</span></td></tr>
            <tr><td>Risk Indicators</td><td>4</td><td><span class="score-badge score-high">HIGH</span></td></tr>
            <tr><td>CSF Categories Mapped</td><td>8</td><td>-</td></tr>
            <tr><td>Priority Recommendations</td><td>5</td><td><span class="score-badge score-high">IMMEDIATE</span></td></tr>
        </table>
    </div>
    
    <div class="section">
        <h2>üîê Detected Permissions</h2>
        <p>The following Azure Application Registration permissions were identified in the project plan:</p>
        
        <div class="permission-item critical">
            <strong>Application.ReadWrite.All</strong> <span class="score-badge score-critical">9/10</span><br>
            Read and write all applications - Can create, modify, and delete applications and their credentials
        </div>
        
        <div class="permission-item critical">
            <strong>Directory.ReadWrite.All</strong> <span class="score-badge score-critical">10/10</span><br>
            Read and write directory data - Can read and write all directory information
        </div>
        
        <div class="permission-item high">
            <strong>Group.ReadWrite.All</strong> <span class="score-badge score-high">7/10</span><br>
            Read and write all groups - Can manage groups and group memberships
        </div>
        
        <div class="permission-item high">
            <strong>Files.ReadWrite.All</strong> <span class="score-badge score-high">8/10</span><br>
            Have full access to all files user can access - Can read, write, and delete files across the organization
        </div>
        
        <div class="permission-item medium">
            <strong>User.Read.All</strong> <span class="score-badge score-medium">5/10</span><br>
            Read all users' full profiles - Can read user profiles and organizational information
        </div>
        
        <div class="permission-item medium">
            <strong>Mail.Send</strong> <span class="score-badge score-medium">4/10</span><br>
            Send mail as a user - Can send emails on behalf of the user
        </div>
    </div>
    
    <div class="section">
        <h2>üéØ NIST CSF 2.0 Categories</h2>
        <p>The identified permissions and content map to the following NIST Cybersecurity Framework 2.0 categories:</p>
        
        <div class="csf-item">
            <strong>PR.AC</strong> - Protect - Access Control<br>
            Access to physical and logical assets and associated facilities is limited to authorized users, processes, and devices
        </div>
        
        <div class="csf-item">
            <strong>ID.RA</strong> - Identify - Risk Assessment<br>
            Risk assessments are performed to identify cybersecurity risks to organizational operations
        </div>
        
        <div class="csf-item">
            <strong>GV.RM</strong> - Govern - Risk Management<br>
            Risk management processes are established, managed, and agreed to by organizational stakeholders
        </div>
        
        <div class="csf-item">
            <strong>PR.DS</strong> - Protect - Data Security<br>
            Information and records are managed consistent with organizational risk strategy
        </div>
        
        <div class="csf-item">
            <strong>ID.AM</strong> - Identify - Asset Management<br>
            Assets are formally managed throughout removal, transfers, and disposition
        </div>
        
        <div class="csf-item">
            <strong>DE.CM</strong> - Detect - Continuous Monitoring<br>
            The organization continuously monitors to identify cybersecurity events
        </div>
        
        <div class="csf-item">
            <strong>GV.PO</strong> - Govern - Policy<br>
            Organizational cybersecurity policy is established, communicated, and enforced
        </div>
        
        <div class="csf-item">
            <strong>PR.AT</strong> - Protect - Awareness and Training<br>
            Personnel are provided cybersecurity awareness education and training
        </div>
    </div>
    
    <div class="section">
        <h2>‚ö†Ô∏è Risk Indicators</h2>
        <p>The following risk indicators were identified through content analysis:</p>
        
        <div class="risk-item critical">
            <strong>Full Application Management</strong> <span class="score-badge score-critical">CRITICAL</span><br>
            Complete control over application configurations poses significant security risks
        </div>
        
        <div class="risk-item critical">
            <strong>Full Directory Access</strong> <span class="score-badge score-critical">CRITICAL</span><br>
            Complete access to organizational directory enables potential lateral movement
        </div>
        
        <div class="risk-item high">
            <strong>Credential Management</strong> <span class="score-badge score-high">HIGH</span><br>
            Ability to manage authentication credentials increases attack surface
        </div>
        
        <div class="risk-item medium">
            <strong>External System Integration</strong> <span class="score-badge score-medium">MEDIUM</span><br>
            Integration with systems outside organizational control introduces additional risks
        </div>
    </div>
    
    <div class="section">
        <h2>üí° Security Recommendations</h2>
        <p>Based on the risk analysis, the following recommendations should be implemented:</p>
        
        <div class="recommendation-item">
            <strong>Critical Risk Mitigation</strong> <span class="score-badge score-critical">CRITICAL</span><br>
            Implement additional controls for critical risks including monitoring, alerting, and approval workflows
        </div>
        
        <div class="recommendation-item">
            <strong>Review High-Risk Permissions</strong> <span class="score-badge score-high">HIGH</span><br>
            Consider using least privilege principle and implement just-in-time access for high-risk permissions
        </div>
        
        <div class="recommendation-item">
            <strong>Implement Conditional Access</strong> <span class="score-badge score-high">HIGH</span><br>
            Use conditional access policies to restrict when and how these permissions can be used
        </div>
        
        <div class="recommendation-item">
            <strong>Multi-Factor Authentication</strong> <span class="score-badge score-high">HIGH</span><br>
            Require MFA for all administrative and high-privilege operations
        </div>
        
        <div class="recommendation-item">
            <strong>Permission Segmentation</strong> <span class="score-badge score-medium">MEDIUM</span><br>
            Consider splitting permissions across multiple applications to reduce blast radius
        </div>
        
        <div class="recommendation-item">
            <strong>Enable Audit Logging</strong> <span class="score-badge score-medium">MEDIUM</span><br>
            Ensure comprehensive audit logging is enabled for all privileged operations
        </div>
        
        <div class="recommendation-item">
            <strong>Regular Permission Reviews</strong> <span class="score-badge score-medium">MEDIUM</span><br>
            Implement quarterly reviews of application permissions and access
        </div>
    </div>
    
    <div class="section">
        <h2>üìã Next Steps</h2>
        <ol>
            <li><strong>Immediate (1-7 days):</strong> Implement conditional access policies for critical permissions</li>
            <li><strong>Short-term (1-4 weeks):</strong> Set up monitoring and alerting for high-risk operations</li>
            <li><strong>Medium-term (1-3 months):</strong> Implement just-in-time access for administrative permissions</li>
            <li><strong>Long-term (3-6 months):</strong> Establish regular permission review processes</li>
        </ol>
    </div>
    
    <footer style="text-align: center; margin-top: 40px; color: #666; border-top: 1px solid #e2e8f0; padding-top: 20px;">
        <p><strong>Generated by Risk Analysis Web App</strong></p>
        <p>Powered by <a href="https://www.nist.gov/cyberframework" target="_blank">NIST CSF 2.0</a> and <a href="https://docs.microsoft.com/en-us/graph/permissions-reference" target="_blank">Microsoft Graph API</a></p>
        <p><em>This report should be reviewed by security professionals and updated based on organizational policies.</em></p>
    </footer>
</body>
</html>