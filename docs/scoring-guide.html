<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk Scoring Guide - Azure Application Registration Risk Analysis</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        .scoring-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .scoring-table th,
        .scoring-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .scoring-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }
        
        .scoring-table tr:last-child td {
            border-bottom: none;
        }
        
        .risk-critical {
            background: rgba(220, 53, 69, 0.1);
            border-left: 4px solid #dc3545;
        }
        
        .risk-high {
            background: rgba(253, 126, 20, 0.1);
            border-left: 4px solid #fd7e14;
        }
        
        .risk-medium {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #ffc107;
        }
        
        .risk-low {
            background: rgba(40, 167, 69, 0.1);
            border-left: 4px solid #28a745;
        }
        
        .score-formula {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }
        
        .csf-mapping-example {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .navigation-breadcrumb {
            background: #f8f9fa;
            padding: 10px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .navigation-breadcrumb a {
            color: #667eea;
            text-decoration: none;
        }
        
        .navigation-breadcrumb a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1><i class="bi bi-shield-check"></i> Risk Scoring Guide</h1>
            <p>Transparent methodology for Azure Application Registration risk assessment</p>
        </div>
    </header>

    <main class="container">
        <div class="navigation-breadcrumb">
            <i class="bi bi-house"></i> <a href="index.html">Home</a> / <span>Scoring Guide</span>
        </div>

        <section class="card">
            <h2><i class="bi bi-info-circle"></i> Overview</h2>
            <p>This scoring guide provides complete transparency into how the Azure Application Registration Risk Analysis tool calculates risk scores and maps findings to NIST Cybersecurity Framework (CSF) 2.0 controls. Our methodology ensures consistent, repeatable, and standardized risk assessments.</p>
        </section>

        <section class="card">
            <h2><i class="bi bi-calculator"></i> Risk Scoring Methodology</h2>
            
            <h3>Overall Risk Score Calculation</h3>
            <div class="score-formula">
                <strong>Formula:</strong><br>
                Overall Risk Score = (Σ Permission Risk Scores + Σ Risk Indicator Scores) / Total Possible Score × 100
                <br><br>
                <strong>Where:</strong><br>
                • Permission Risk Scores = Individual permission scores (1-10 scale)<br>
                • Risk Indicator Scores = Content-based risk indicators (2-10 points each)<br>
                • Total Possible Score = Maximum possible score for all identified elements<br>
                • Final Score = Normalized to 0-100 scale
            </div>

            <h3>Permission Risk Scores</h3>
            <table class="scoring-table">
                <thead>
                    <tr>
                        <th>Permission</th>
                        <th>Risk Level</th>
                        <th>Score</th>
                        <th>Rationale</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="risk-critical">
                        <td>Directory.ReadWrite.All</td>
                        <td>Critical</td>
                        <td>10/10</td>
                        <td>Complete directory control, can modify any organizational data</td>
                    </tr>
                    <tr class="risk-critical">
                        <td>RoleManagement.ReadWrite.All</td>
                        <td>Critical</td>
                        <td>10/10</td>
                        <td>Can assign/modify any role, including administrative privileges</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Application.ReadWrite.All</td>
                        <td>High</td>
                        <td>9/10</td>
                        <td>Can create/modify applications and access credentials</td>
                    </tr>
                    <tr class="risk-high">
                        <td>User.ReadWrite.All</td>
                        <td>High</td>
                        <td>8/10</td>
                        <td>Can modify user accounts and profiles</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Group.ReadWrite.All</td>
                        <td>High</td>
                        <td>7/10</td>
                        <td>Can modify group memberships and security groups</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Policy.ReadWrite.All</td>
                        <td>High</td>
                        <td>8/10</td>
                        <td>Can modify security and access policies</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Files.ReadWrite.All</td>
                        <td>High</td>
                        <td>7/10</td>
                        <td>Can access and modify all organizational files</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>Directory.Read.All</td>
                        <td>Medium</td>
                        <td>6/10</td>
                        <td>Read access to directory data, privacy implications</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>Application.Read.All</td>
                        <td>Medium</td>
                        <td>6/10</td>
                        <td>Can read application configurations and metadata</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>User.Read.All</td>
                        <td>Medium</td>
                        <td>5/10</td>
                        <td>Can read user profiles and organizational information</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>AuditLog.Read.All</td>
                        <td>Medium</td>
                        <td>5/10</td>
                        <td>Access to audit logs, potential security intelligence</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>SecurityEvents.Read.All</td>
                        <td>Medium</td>
                        <td>6/10</td>
                        <td>Access to security event data</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>Group.Read.All</td>
                        <td>Medium</td>
                        <td>4/10</td>
                        <td>Can read group information and memberships</td>
                    </tr>
                    <tr class="risk-low">
                        <td>Mail.Read</td>
                        <td>Low</td>
                        <td>3/10</td>
                        <td>Limited to reading mail, minimal organizational impact</td>
                    </tr>
                    <tr class="risk-low">
                        <td>Mail.Send</td>
                        <td>Low</td>
                        <td>2/10</td>
                        <td>Can send mail on behalf of user, low privilege</td>
                    </tr>
                    <tr class="risk-low">
                        <td>User.Read</td>
                        <td>Low</td>
                        <td>1/10</td>
                        <td>Basic profile reading, minimal risk</td>
                    </tr>
                </tbody>
            </table>

            <h3>Risk Indicator Scoring</h3>
            <table class="scoring-table">
                <thead>
                    <tr>
                        <th>Risk Indicator</th>
                        <th>Level</th>
                        <th>Score</th>
                        <th>Detection Criteria</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="risk-critical">
                        <td>Global Administrator Access</td>
                        <td>Critical</td>
                        <td>+10</td>
                        <td>Pattern: "global.*admin" in content</td>
                    </tr>
                    <tr class="risk-critical">
                        <td>Full Application Management</td>
                        <td>Critical</td>
                        <td>+10</td>
                        <td>Permission: Application.ReadWrite.All detected</td>
                    </tr>
                    <tr class="risk-critical">
                        <td>Full Directory Access</td>
                        <td>Critical</td>
                        <td>+10</td>
                        <td>Permission: Directory.ReadWrite.All detected</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Privilege Escalation Risk</td>
                        <td>High</td>
                        <td>+7</td>
                        <td>Pattern: "privileg.*escalat" in content</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Destructive Operations</td>
                        <td>High</td>
                        <td>+7</td>
                        <td>Pattern: "(delete|remove).*all" in content</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Credential Management</td>
                        <td>High</td>
                        <td>+7</td>
                        <td>Pattern: "(credential|secret|password).*manage" in content</td>
                    </tr>
                    <tr class="risk-high">
                        <td>Role Management Access</td>
                        <td>High</td>
                        <td>+7</td>
                        <td>Pattern: "role.*management" in content</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>External System Integration</td>
                        <td>Medium</td>
                        <td>+4</td>
                        <td>Pattern: "external.*integration" in content</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>Third-party Access</td>
                        <td>Medium</td>
                        <td>+4</td>
                        <td>Pattern: "third.*party" in content</td>
                    </tr>
                    <tr class="risk-medium">
                        <td>Compliance Requirements</td>
                        <td>Medium</td>
                        <td>+4</td>
                        <td>Patterns: "gdpr", "hipaa", "sox", "pci.*dss" in content</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="card">
            <h2><i class="bi bi-bullseye"></i> NIST CSF 2.0 Control Mapping</h2>
            
            <h3>Mapping Methodology</h3>
            <p>Each detected permission and risk indicator is mapped to specific NIST CSF 2.0 controls based on their function and impact. The mapping follows a systematic approach:</p>
            
            <h4>1. Primary Control Assignment</h4>
            <p>Each permission is assigned to primary controls based on its core function:</p>
            
            <table class="scoring-table">
                <thead>
                    <tr>
                        <th>CSF Category</th>
                        <th>Primary Controls</th>
                        <th>Permission Types</th>
                        <th>Example Controls</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>PR.AC</strong> - Access Control</td>
                        <td>PR.AC-01, PR.AC-02, PR.AC-04, PR.AC-06</td>
                        <td>All permission-based access</td>
                        <td>PR.AC-01: Access permissions are managed and enforced</td>
                    </tr>
                    <tr>
                        <td><strong>ID.AM</strong> - Asset Management</td>
                        <td>ID.AM-02, ID.AM-05</td>
                        <td>Directory and application reading</td>
                        <td>ID.AM-02: Assets are inventoried and managed</td>
                    </tr>
                    <tr>
                        <td><strong>GV.RM</strong> - Risk Management</td>
                        <td>GV.RM-01, GV.RM-02, GV.RM-03</td>
                        <td>High-risk write permissions</td>
                        <td>GV.RM-01: Risk management processes are established</td>
                    </tr>
                    <tr>
                        <td><strong>PR.DS</strong> - Data Security</td>
                        <td>PR.DS-01, PR.DS-02, PR.DS-05</td>
                        <td>Data access permissions</td>
                        <td>PR.DS-01: Data is protected at rest</td>
                    </tr>
                    <tr>
                        <td><strong>DE.CM</strong> - Continuous Monitoring</td>
                        <td>DE.CM-01, DE.CM-06, DE.CM-08</td>
                        <td>Audit and security event permissions</td>
                        <td>DE.CM-01: Networks and environments are monitored</td>
                    </tr>
                </tbody>
            </table>

            <h4>2. Specific Control Mapping Examples</h4>

            <div class="csf-mapping-example">
                <strong>Example: Directory.ReadWrite.All</strong><br>
                <strong>Mapped Controls:</strong>
                <ul>
                    <li><strong>PR.AC-01:</strong> Access permissions are managed and enforced</li>
                    <li><strong>PR.AC-04:</strong> Access is managed and enforced for remote access</li>
                    <li><strong>GV.RM-01:</strong> Risk management processes are established and managed</li>
                    <li><strong>GV.RM-03:</strong> Risk management activities and outcomes are communicated</li>
                    <li><strong>ID.AM-02:</strong> Assets are inventoried and managed throughout their lifecycle</li>
                </ul>
                <strong>Rationale:</strong> This permission provides complete directory access, requiring strict access control (PR.AC), comprehensive risk management (GV.RM), and asset awareness (ID.AM).
            </div>

            <div class="csf-mapping-example">
                <strong>Example: User.Read.All</strong><br>
                <strong>Mapped Controls:</strong>
                <ul>
                    <li><strong>PR.AC-02:</strong> Physical access to organizational assets is managed and enforced</li>
                    <li><strong>PR.DS-01:</strong> Data is protected at rest</li>
                    <li><strong>ID.AM-05:</strong> Resources are prioritized based on classification and business impact</li>
                </ul>
                <strong>Rationale:</strong> Read access to user data requires data protection (PR.DS) and proper asset classification (ID.AM).
            </div>

            <h4>3. Content-Based Control Assignment</h4>
            <p>Additional controls are assigned based on content analysis keywords:</p>
            
            <table class="scoring-table">
                <thead>
                    <tr>
                        <th>Keywords in Content</th>
                        <th>Assigned Controls</th>
                        <th>Rationale</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>risk, assessment, evaluation</td>
                        <td>ID.RA-01, ID.RA-02, GV.RM-01</td>
                        <td>Risk assessment activities require risk management controls</td>
                    </tr>
                    <tr>
                        <td>monitoring, detection, surveillance</td>
                        <td>DE.CM-01, DE.CM-06, DE.AE-01</td>
                        <td>Monitoring activities map to detection controls</td>
                    </tr>
                    <tr>
                        <td>policy, procedure, governance</td>
                        <td>GV.PO-01, GV.PO-02, GV.GV-01</td>
                        <td>Governance activities require policy controls</td>
                    </tr>
                    <tr>
                        <td>backup, recovery, restore</td>
                        <td>RC.RP-01, RC.RP-03, RC.CO-01</td>
                        <td>Recovery activities map to recovery controls</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="card">
            <h2><i class="bi bi-bar-chart"></i> Risk Level Classification</h2>
            
            <table class="scoring-table">
                <thead>
                    <tr>
                        <th>Risk Level</th>
                        <th>Score Range</th>
                        <th>Description</th>
                        <th>Recommended Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="risk-critical">
                        <td><strong>Critical</strong></td>
                        <td>80-100</td>
                        <td>Immediate threat to organizational security</td>
                        <td>Immediate review, enhanced controls, governance approval required</td>
                    </tr>
                    <tr class="risk-high">
                        <td><strong>High</strong></td>
                        <td>60-79</td>
                        <td>Significant security risk requiring attention</td>
                        <td>Conditional access, monitoring, management approval</td>
                    </tr>
                    <tr class="risk-medium">
                        <td><strong>Medium</strong></td>
                        <td>30-59</td>
                        <td>Moderate risk with manageable impact</td>
                        <td>Standard controls, regular review, documented justification</td>
                    </tr>
                    <tr class="risk-low">
                        <td><strong>Low</strong></td>
                        <td>0-29</td>
                        <td>Low risk with minimal security impact</td>
                        <td>Standard monitoring, periodic review</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="card">
            <h2><i class="bi bi-check-circle"></i> Quality Assurance</h2>
            
            <h3>Validation Process</h3>
            <ul>
                <li><strong>Permission Database:</strong> Regularly updated with latest Microsoft Graph API permissions</li>
                <li><strong>NIST CSF Alignment:</strong> Mappings reviewed quarterly against NIST CSF 2.0 guidance</li>
                <li><strong>Industry Standards:</strong> Scoring aligned with OWASP, SANS, and enterprise security frameworks</li>
                <li><strong>Expert Review:</strong> Methodology reviewed by cybersecurity professionals</li>
            </ul>

            <h3>Limitations and Considerations</h3>
            <ul>
                <li>Scoring is based on general risk patterns and may not reflect organization-specific contexts</li>
                <li>Content analysis uses pattern matching and may miss context-specific risks</li>
                <li>Risk scores should be supplemented with organizational risk assessments</li>
                <li>Scoring methodology may be updated as new threats and permissions emerge</li>
            </ul>
        </section>

        <section class="card">
            <h2><i class="bi bi-arrow-left-circle"></i> Return to Application</h2>
            <p>Ready to analyze your Azure Application Registration? <a href="index.html" class="btn btn-primary"><i class="bi bi-house"></i> Return to Risk Analysis Tool</a></p>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Risk Analysis Tool - Built for GitHub Pages</p>
            <p>Methodology based on <a href="https://www.nist.gov/cyberframework" target="_blank">NIST CSF 2.0</a> and <a href="https://docs.microsoft.com/en-us/graph/permissions-reference" target="_blank">Microsoft Graph API</a></p>
            <p><strong>Transparency:</strong> <a href="scoring-guide.html">Risk Scoring Guide</a> | <a href="#" onclick="window.print()">Print This Guide</a></p>
        </div>
    </footer>
</body>
</html>